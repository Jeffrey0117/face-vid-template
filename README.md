# 面相影片模板專案

> **⚠️ 重要提醒：本專案必須搭配剪映 5.9 未加密版本使用！**

此專案提供自動化面相分析影片生成工具，可批量創建包含不同面相類型的影片專案。

## 📁 專案結構

```
face-vid-template/
├── README.md                    # 說明文檔（本文件）
├── template_video_replacer.py   # 核心影片替換腳本
├── batch_export_faces.py        # 批量導出影片腳本
├── pyJianYingDraft/            # 剪映草稿操作庫
│   ├── __init__.py             # 初始化文件
│   ├── *.py                    # 各種功能模組
│   ├── assets/                 # 草稿模板資源
│   └── metadata/               # 元數據定義
├── videos/                     # 面相影片素材庫
│   ├── 沉浸情色.mp4             # 面相類型影片
│   ├── 典型妾相.mp4             # 面相類型影片
│   ├── 婊子.mp4                 # 面相類型影片
│   ├── 頂級貴相.mp4             # 面相類型影片
│   └── logo.jpg                # 素材圖片
└── 面相專案/                   # 模板專案資料夾
```

## ⚙️ 環境需求

### 必要軟體

- **剪映專業版 5.9 未加密版本** ⚠️ 關鍵要求
- Python 3.7+
- Windows 作業系統

### 依賴套件

- `json` - JSON 數據處理
- `os` - 作業系統接口
- `shutil` - 文件操作工具
- `glob` - 檔案模式匹配
- `pyJianYingDraft` - 剪映草稿操作庫（內建）

## 🚀 使用說明

### 步驟 1：準備模板專案

1. 也就是這個 REPO 的「**面相專案**」

### 步驟 2：準備影片素材

確認 [`videos`](videos) 資料夾中包含面相類型影片，最多只能四個字，太多會讓影片標題爆炸。
在這個 REPO 中是以下四個不同範例：

- `典型妾相.mp4`
- `婊子.mp4`
- `頂級貴相.mp4`
- `沉浸情色.mp4`

### 步驟 3：執行批量生成

```bash
python template_video_replacer.py
```

### 步驟 4：檢查生成結果

腳本會在剪映草稿資料夾中生成對應的專案：

- `面相專案_典型的妾相`
- `面相專案_婊子`
- `面相專案_頂級貴相`
- `面相專案_沉浸情色`

### 步驟 5：批量導出影片

生成專案後，使用批量導出腳本將所有面相專案導出為影片：

```bash
# 使用默認設置（桌面輸出，1080P，30fps）
python batch_export_faces.py

# 指定輸出路徑
python batch_export_faces.py "C:\Users\YourName\Desktop\face_exports"

# 指定輸出路徑、解析度、幀率
python batch_export_faces.py "C:\Users\YourName\Desktop\face_exports" 1080P 24fps
```

**批量導出參數說明:**

- `output_path`: 可選，影片輸出資料夾路徑，默認為桌面
- `resolution`: 可選，導出分辨率 (480P, 720P, 1080P, 2K, 4K, 8K)，默認 1080P
- `framerate`: 可選，導出幀率 (24fps, 25fps, 30fps, 50fps, 60fps)，默認 30fps

### 步驟 6：獲取最終影片

批量導出完成後，所有影片將保存在指定的輸出資料夾中。

## 🎬 完整工作流程

### 自動化面相影片生成流程

1. **準備階段**

   - 確保「面相專案」模板存在
   - 在 `videos/` 資料夾放置面相類型影片

2. **批量生成專案**

   - 執行 `template_video_replacer.py`
   - 系統自動為每個影片創建對應的剪映專案
   - 自動替換影片素材和相關文字

3. **批量導出影片**

   - 執行 `batch_export_faces.py`
   - 系統自動掃描所有面相專案草稿
   - 批量導出為 MP4 影片檔案

4. **結果獲取**
   - 所有影片保存在指定輸出資料夾
   - 每個影片對應一個面相類型

## 🔧 技術實現

### 草稿文件結構

系統操作的剪映草稿位於：

```
C:\Users\{用戶名}\AppData\Local\JianyingPro\User Data\Projects\com.lveditor.draft\
```

每個專案包含：

- `draft_content.json` - 主要的專案配置文件
- `draft_meta_info.json` - 專案元數據
- `extra.json` - 附加設置信息

## ⚠️ 重要注意事項

### 剪映版本要求

- **必須使用剪映 5.9 未加密版本**
- 較新版本可能會對草稿文件進行加密，導致無法正常讀取和修改
- 如果發現專案無法正常生成，請檢查剪映版本

## 🛠️ 故障排除

### 專案生成問題

**Q：執行後沒有生成新專案？**
A：檢查：

1. 是否使用剪映 5.9 未加密版本
2. 「面相專案」模板是否存在
3. videos 資料夾中是否有對應的影片檔案

**Q：生成的專案無法在剪映中打開？**
A：可能是：

1. 剪映版本不匹配
2. 草稿文件格式有誤
3. 檔案權限問題

**Q：文字沒有正確替換？**
A：確認：

1. 模板中的文字是否包含「婊子無情」等關鍵字
2. 文字格式是否正確
3. JSON 結構是否完整

### 批量導出問題

**Q：批量導出提示「未找到任何面相專案草稿」？**
A：請檢查：

1. 是否已先執行 `template_video_replacer.py` 生成專案
2. 剪映草稿路徑是否正確
3. 專案名稱格式是否正確（以「面相專案\_」開頭）

**Q：導出過程中提示「未找到導出路徑框」？**
A：這表示：

1. 剪映軟體未處於主頁面
2. 剪映版本與腳本不兼容

請確保剪映處於正確狀態。

**Q：如何中途停止批量導出？**
A：使用 `Ctrl+C` 強制停止腳本。但請注意，正在導出的影片可能會被中斷。

---

**專案版本**：v1.0  
**最後更新**：2025-09-15  
**相容性**：剪映專業版 5.9（未加密版本）
